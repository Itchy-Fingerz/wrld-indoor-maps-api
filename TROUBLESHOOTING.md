Troubleshooting
===================

Indoor maps can be complex! On this page you'll find some common problems and fixes for them.

1. [Failed Schema Validation](#failed-schema-validation)
1. [Failure to find indoor routes](#failure-to-find-indoor-routes)

### Failed Schema Validation 
The submission service will email you if your map doesn't meet the specification for our geoJSON.

Common problems are:
1. Incorrect CRS. The CRS (Coordinate Reference System) must be WGS84 ([EPSG: 3857](http://spatialreference.org/ref/sr-org/6864/)).  This can be set at the time of export from QGIS.
1. Missing ids.  The ids for features can be generated by following the instructions in [the tutorial](TUTORIAL.md#user-content-generate-feature-ids).

### Failure to find indoor routes

To create a valid graph for routing, paths must connect to each other by sharing exactly the same point. It can be difficult to see if paths are intersecting correctly in QGIS.  If not, the routing service will fail to find a route connecting two points.

You can check the path definitions for a single floor in QGIS, using the v.net.components algorithm from the GRASS GIS plugin. 
1. Ensure the GRASS GIS plugin is installed.
1. In the Toolbox panel (View/Panels/Toolbox), open the v.net.components algorithm from the Vector collection under GRASS GIS.
1. Select the layer corresponding to the floor paths and click run.
1. The algorithm will add a "Network Components Line" layer in QGIS.  Right-click this and select "Properties".
1. Ensure the "Style" option is selected and change "Single symbol" to "Categorized" in the drop-down at the top.
1. Check the selected column is "comp" (or "123comp"), and click "Classify".

This will apply a different color to each unconnected part of the graph.  If the graph is fully connected, there will ony be one color and one legend entry under "Network Components Line".  If the graph is not fully connected, you can see where you need to add vertices in QGIS to connect components.